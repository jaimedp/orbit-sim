{"version":3,"file":null,"sources":["../../src/js/universe.js","../../src/js/body.js","../../src/js/index.js"],"sourcesContent":["export default class Universe {\n  constructor(bodies) {\n    this.bodies = bodies;\n    this.dt = 24*3600*7;\n  }\n\n  step() {\n    // calculate all the forces\n    for (const body of this.bodies) {\n      for (const other of this.bodies) {\n        if (body === other) {\n          continue;\n        }\n\n        const {fx, fy} = body.computeAttraction(other);\n        body.addForce(fx, fy);\n      }\n    }\n\n    // integrate new position for all bodies\n    this.bodies.forEach((b) => b.integrate(this.dt));\n  }\n\n  render(ctx, toScreen) {\n    // render new pos\n    this.bodies.forEach((b) => b.render(ctx, toScreen));\n  }\n}\n","const G = 6.67428e-11;\n\nconst defaultOptions = Object.freeze({\n  color: '#f00'\n});\n\nexport default class Body {\n  constructor(mass = 1, name = 'Body', options = {}) {\n    this.name = name;\n    this.mass = mass;\n    this.options = Object.assign({}, defaultOptions, options);\n\n    this.rad = 5;\n\n    this.x = this.options.x || 0;\n    this.y = this.options.y || 0;\n    this.vx = this.options.vx || 0;\n    this.vy = this.options.vy || 0;\n\n    this.forces = { x: 0, y: 0 };\n  }\n\n  computeAttraction(other) {\n    const dx = other.x - this.x;\n    const dy = other.y - this.y;\n\n    const d2 = dx*dx + dy*dy;\n\n    if (d2 === 0) {\n      throw new Error('coliision!');\n    }\n\n    const f = G * this.mass * other.mass / d2;\n    const t = Math.atan2(dy, dx);\n\n    return {\n      fx: Math.cos(t) * f,\n      fy: Math.sin(t) * f\n    };\n  }\n\n  addForce(fx, fy) {\n    this.forces.x += fx;\n    this.forces.y += fx;\n  }\n\n  integrate(dt) {\n    const fx = this.forces.x;\n    const fy = this.forces.y;\n\n    const v0x = this.vx;\n    const v0y = this.vy;\n\n    this.vx += fx / this.mass * dt;\n    this.vy += fy / this.mass * dt;\n\n    this.x += (v0x + this.vx) * 0.5 * dt;\n    this.y += (v0y + this.vy) * 0.5 * dt;\n\n    this.forces.x = 0;\n    this.forces.y = 0;\n  }\n\n  render(ctx, toScreen) {\n    const {x, y} = toScreen(this.x, this.y);\n\n    ctx.beginPath();\n    ctx.arc(x, y, this.rad, 0, 2 * Math.PI, false);\n    ctx.fillStyle = this.options.color;\n    ctx.fill();\n  }\n}\n","import Universe from './universe';\nimport Body from './body';\n\nconst AU = (149.6e6 * 1000);\nconst SCALE = 50 / AU;\n\nconst b1 = new Body(1.98892 * Math.pow(10, 32), 'sun', { color: 'yellow' });\nconst b2 = new Body(5.9742 * Math.pow(10, 24), 'earth', { color: 'blue', x: -1 * AU, vy: 29.783 * 1000 });\nconst b3 = new Body(4.8685 * Math.pow(10, 24), 'venus', {color: 'red', x: 0.723 * AU, vy: -35.02 * 1000});\n\nconst universe = new Universe([b1, b2, b3]);\n\n\nconst canvas = document.getElementById('myCanvas');\nconst context = canvas.getContext('2d');\nconst centerX = canvas.width / 2;\nconst centerY = canvas.height / 2;\n\nconst toScreen = (x, y) => ({x: x * SCALE + centerX, y: centerY + y * SCALE});\nconst btn = document.getElementById('step');\n\nuniverse.render(context, toScreen);\n\nbtn.addEventListener('click', () => {\n  universe.step();\n  context.clearRect(0, 0, canvas.width, canvas.height);\n  universe.render(context, toScreen);\n});\n\n"],"names":["Universe","bodies","dt","body","other","computeAttraction","fx","fy","addForce","forEach","b","integrate","ctx","toScreen","render","G","defaultOptions","Object","freeze","Body","mass","name","options","assign","rad","x","y","vx","vy","forces","dx","dy","d2","Error","f","t","Math","atan2","cos","sin","v0x","v0y","beginPath","arc","PI","fillStyle","color","fill","AU","SCALE","b1","pow","b2","b3","universe","canvas","document","getElementById","context","getContext","centerX","width","centerY","height","btn","addEventListener","step","clearRect"],"mappings":"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"}